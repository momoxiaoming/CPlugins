apply plugin: 'java-library'
apply plugin: 'kotlin'
apply plugin: "groovy"
apply plugin: 'maven'
apply plugin: 'java-gradle-plugin'
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation gradleApi()
    implementation localGroovy()
    compileOnly deps.gradle.agp

    implementation deps.kotlin.stdlib
    implementation deps.kotlin.plugin
    compileOnly deps.aabresguard.core
    api(deps.aabresguard.core) {
        exclude group: "com.google.guava", module: "guava"
        exclude group: "com.android.tools.build", module: "gradle"
    }

}

configurations {
    all*.exclude group: "com.android.tools.build", module: "bundletool"
}

sourceCompatibility= 1.8
targetCompatibility= 1.8  //使用1.8编译

if(!properties.get("isLocal").toBoolean()){
    uploadArchives  {
        repositories {
            mavenDeployer  {
                repository(url: uri('http://dnsdk.vimedia.cn:8081/repository/Viapp-release')) {
                    authentication(userName: 'vapp-deployment', password: 'pwd123456')
                }
                pom {
                    groupId=rootProject.cPlugins.aab.group
                    artifactId=rootProject.cPlugins.aab.artifactId
                    version=rootProject.cPlugins.aab.versionName
                }
            }
        }
    }
}else{
    uploadArchives {
        repositories {
            mavenDeployer {
                repository(url: uri('../../repo'))
                pom {
                    groupId = rootProject.cPlugins.aab.group
                    artifactId = rootProject.cPlugins.aab.artifactId
                    version = rootProject.cPlugins.aab.versionName
                }
            }
        }
    }
}